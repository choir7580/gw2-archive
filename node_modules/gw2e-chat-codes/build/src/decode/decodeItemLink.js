"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.decodeItemLink = void 0;
var static_1 = require("../static");
function decodeItemLink(struct) {
    var quantity = struct.read1Byte();
    var id = struct.read3Bytes();
    var flags = struct.read1Byte();
    // Skin
    var skin;
    if (hasFlag(flags, static_1.ITEM_FLAGS.skin)) {
        skin = struct.read3Bytes();
        struct.read1Byte(); // Skip the next byte (always 0x00)
    }
    // Upgrade slot 1
    var upgrades;
    if (hasFlag(flags, static_1.ITEM_FLAGS.upgrade1)) {
        upgrades = [struct.read3Bytes()];
        struct.read1Byte(); // Skip the next byte (always 0x00)
    }
    // Upgrade slot 2
    if (hasFlag(flags, static_1.ITEM_FLAGS.upgrade2)) {
        upgrades.push(struct.read3Bytes());
    }
    return { type: 'item', quantity: quantity, id: id, skin: skin, upgrades: upgrades };
}
exports.decodeItemLink = decodeItemLink;
function hasFlag(flags, flag) {
    return (flags & flag) === flag;
}
//# sourceMappingURL=decodeItemLink.js.map